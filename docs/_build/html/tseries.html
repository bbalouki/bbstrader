

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Time Series &mdash; bbstrader 0.2.092 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=97badf68"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Trading Execution" href="trading.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            bbstrader
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">bbstrader</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="btengine.html">Backtesting Egine</a></li>
<li class="toctree-l2"><a class="reference internal" href="compat.html">compat module</a></li>
<li class="toctree-l2"><a class="reference internal" href="config.html">configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="core.html">core package</a></li>
<li class="toctree-l2"><a class="reference internal" href="ibkr.html">ibkr package</a></li>
<li class="toctree-l2"><a class="reference internal" href="metatrader.html">MetaTrader5 (MT5) Trading</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="trading.html">Trading Execution</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Time Series</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tseries.ArimaGarchModel"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.backtest_strategy"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.backtest_strategy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.calculate_signals"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.calculate_signals()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.execute_trading_strategy"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.execute_trading_strategy()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.fit_best_arima"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.fit_best_arima()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.fit_garch"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.fit_garch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.generate_predictions"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.generate_predictions()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.get_prediction"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.get_prediction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.load_and_prepare_data"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.load_and_prepare_data()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.plot_cumulative_returns"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.plot_cumulative_returns()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.predict_next_return"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.predict_next_return()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.ArimaGarchModel.show_arima_garch_results"><code class="docutils literal notranslate"><span class="pre">ArimaGarchModel.show_arima_garch_results()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.KFHedgeRatio"><code class="docutils literal notranslate"><span class="pre">KFHedgeRatio()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.KFSmoother"><code class="docutils literal notranslate"><span class="pre">KFSmoother()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.KalmanFilterModel"><code class="docutils literal notranslate"><span class="pre">KalmanFilterModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tseries.KalmanFilterModel.Array"><code class="docutils literal notranslate"><span class="pre">KalmanFilterModel.Array</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.KalmanFilterModel.calc_slope_intercep"><code class="docutils literal notranslate"><span class="pre">KalmanFilterModel.calc_slope_intercep()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.KalmanFilterModel.calculate_etqt"><code class="docutils literal notranslate"><span class="pre">KalmanFilterModel.calculate_etqt()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.OrnsteinUhlenbeck"><code class="docutils literal notranslate"><span class="pre">OrnsteinUhlenbeck</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#tseries.OrnsteinUhlenbeck.estimate_parameters"><code class="docutils literal notranslate"><span class="pre">OrnsteinUhlenbeck.estimate_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.OrnsteinUhlenbeck.ornstein_uhlenbeck"><code class="docutils literal notranslate"><span class="pre">OrnsteinUhlenbeck.ornstein_uhlenbeck()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#tseries.OrnsteinUhlenbeck.simulate_process"><code class="docutils literal notranslate"><span class="pre">OrnsteinUhlenbeck.simulate_process()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.analyze_cointegrated_pairs"><code class="docutils literal notranslate"><span class="pre">analyze_cointegrated_pairs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.check_stationarity"><code class="docutils literal notranslate"><span class="pre">check_stationarity()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.compute_pair_metrics"><code class="docutils literal notranslate"><span class="pre">compute_pair_metrics()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.find_cointegrated_pairs"><code class="docutils literal notranslate"><span class="pre">find_cointegrated_pairs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.fit_best_arima"><code class="docutils literal notranslate"><span class="pre">fit_best_arima()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.fit_garch"><code class="docutils literal notranslate"><span class="pre">fit_garch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.get_corr"><code class="docutils literal notranslate"><span class="pre">get_corr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.get_prediction"><code class="docutils literal notranslate"><span class="pre">get_prediction()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.load_and_prepare_data"><code class="docutils literal notranslate"><span class="pre">load_and_prepare_data()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.predict_next_return"><code class="docutils literal notranslate"><span class="pre">predict_next_return()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.remove_correlated_assets"><code class="docutils literal notranslate"><span class="pre">remove_correlated_assets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.remove_stationary_assets"><code class="docutils literal notranslate"><span class="pre">remove_stationary_assets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.run_cadf_test"><code class="docutils literal notranslate"><span class="pre">run_cadf_test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.run_coint_test"><code class="docutils literal notranslate"><span class="pre">run_coint_test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.run_hurst_test"><code class="docutils literal notranslate"><span class="pre">run_hurst_test()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.run_kalman_filter"><code class="docutils literal notranslate"><span class="pre">run_kalman_filter()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.select_assets"><code class="docutils literal notranslate"><span class="pre">select_assets()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tseries.select_candidate_pairs"><code class="docutils literal notranslate"><span class="pre">select_candidate_pairs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">bbstrader</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">bbstrader</a></li>
      <li class="breadcrumb-item active">Time Series</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/tseries.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-tseries">
<span id="time-series"></span><h1>Time Series<a class="headerlink" href="#module-tseries" title="Link to this heading"></a></h1>
<p>The <cite>tseries</cite> module is a designed for conducting
advanced time series analysis in financial markets.
It leverages statistical models and algorithms to perform
tasks such as cointegration testing, volatility modeling,
and filter-based estimation to assist in trading strategy development,
market analysis, and financial data exploration.</p>
<dl class="py class">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">ArimaGarchModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">252</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This class implements a time serie model
that combines <cite>ARIMA (AutoRegressive Integrated Moving Average)</cite>
and <cite>GARCH (Generalized Autoregressive Conditional Heteroskedasticity)</cite> models
to predict future returns based on historical price data.</p>
<p>The model is implemented in the following steps:
1. Data Preparation: Load and prepare the historical price data.
2. Modeling: Fit the ARIMA model to the data and then fit the GARCH model to the residuals.
3. Prediction: Predict the next return using the ARIMA model and the next volatility using the GARCH model.
4. Trading Strategy: Execute the trading strategy based on the predictions.
5. Vectorized Backtesting: Backtest the trading strategy using the historical data.</p>
<dl>
<dt>Exemple:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bbstrader.tseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">ArimaGarchModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bbstrader.tseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">load_and_prepare_data</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># ARCH SPY Vectorize Backtest</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">k</span> <span class="o">=</span> <span class="mi">252</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s2">&quot;SPY&quot;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2010-01-02&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2015-12-31&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">arch</span> <span class="o">=</span> <span class="n">ArimaGarchModel</span><span class="p">(</span><span class="s2">&quot;SPY&quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">k</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">df</span> <span class="o">=</span> <span class="n">load_and_prepare_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">arch</span><span class="o">.</span><span class="n">show_arima_garch_results</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;diff_log_return&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="o">-</span><span class="n">k</span><span class="p">:])</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">arch</span><span class="o">.</span><span class="n">backtest_strategy</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.backtest_strategy">
<span class="sig-name descname"><span class="pre">backtest_strategy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.backtest_strategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.backtest_strategy" title="Link to this definition"></a></dt>
<dd><p>Performs a backtest of the strategy over
the entire dataset, plotting cumulative returns.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.calculate_signals">
<span class="sig-name descname"><span class="pre">calculate_signals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.calculate_signals"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.calculate_signals" title="Link to this definition"></a></dt>
<dd><p>Calculates the trading signal based on the prediction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>window_data</strong> (<em>np.array</em>) – The dataset for a specific window period.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The trading signal (‘LONG’, ‘SHORT’, or None).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.execute_trading_strategy">
<span class="sig-name descname"><span class="pre">execute_trading_strategy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictions</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.execute_trading_strategy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.execute_trading_strategy" title="Link to this definition"></a></dt>
<dd><p>Executes the trading strategy based on a list
of predictions, determining positions to take.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>predictions</strong> (<em>list</em>) – A list of predicted returns.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of positions (1 for ‘LONG’, -1 for ‘SHORT’, 0 for ‘HOLD’).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.fit_best_arima">
<span class="sig-name descname"><span class="pre">fit_best_arima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.fit_best_arima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.fit_best_arima" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Fits the ARIMA model to the provided window of data,</dt><dd><p>selecting the best model based on AIC.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>window_data</strong> (<em>np.array</em>) – The dataset for a specific window period.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The best fitted ARIMA model based on AIC.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ARIMA model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.fit_garch">
<span class="sig-name descname"><span class="pre">fit_garch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.fit_garch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.fit_garch" title="Link to this definition"></a></dt>
<dd><p>Fits the GARCH model to the residuals of the best ARIMA model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>window_data</strong> (<em>np.array</em>) – The dataset for a specific window period.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Contains the ARIMA result and GARCH result.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.generate_predictions">
<span class="sig-name descname"><span class="pre">generate_predictions</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.generate_predictions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.generate_predictions" title="Link to this definition"></a></dt>
<dd><p>Generator that yields predictions one by one.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.get_prediction">
<span class="sig-name descname"><span class="pre">get_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.get_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.get_prediction" title="Link to this definition"></a></dt>
<dd><p>Generates a prediction for the next return based on a window of data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>window_data</strong> (<em>np.array</em>) – The dataset for a specific window period.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted next return.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.load_and_prepare_data">
<span class="sig-name descname"><span class="pre">load_and_prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.load_and_prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.load_and_prepare_data" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Prepares the dataset by calculating logarithmic returns</dt><dd><p>and differencing if necessary.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – <cite>The raw dataset containing at least the ‘Close’ prices</cite>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The dataset with additional columns</dt><dd><p>for log returns and differenced log returns.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.plot_cumulative_returns">
<span class="sig-name descname"><span class="pre">plot_cumulative_returns</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">strategy_returns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">buy_and_hold_returns</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dates</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.plot_cumulative_returns"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.plot_cumulative_returns" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Plots the cumulative returns of the ARIMA+GARCH strategy against</dt><dd><p>a buy-and-hold strategy.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strategy_returns</strong> (<em>np.array</em>) – Cumulative returns from the strategy.</p></li>
<li><p><strong>buy_and_hold_returns</strong> (<em>np.array</em>) – Cumulative returns from a buy-and-hold strategy.</p></li>
<li><p><strong>dates</strong> (<em>pd.Index</em>) – The dates corresponding to the returns.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.predict_next_return">
<span class="sig-name descname"><span class="pre">predict_next_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arima_result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">garch_result</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.predict_next_return"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.predict_next_return" title="Link to this definition"></a></dt>
<dd><dl class="simple">
<dt>Predicts the next return using the ARIMA model</dt><dd><p>and the next volatility using the GARCH model.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arima_result</strong> (<em>ARIMA model</em>) – The ARIMA model result.</p></li>
<li><p><strong>garch_result</strong> (<em>GARCH model</em>) – The GARCH model result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted next return.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.ArimaGarchModel.show_arima_garch_results">
<span class="sig-name descname"><span class="pre">show_arima_garch_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">acf</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_resid</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#ArimaGarchModel.show_arima_garch_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.ArimaGarchModel.show_arima_garch_results" title="Link to this definition"></a></dt>
<dd><p>Displays the ARIMA and GARCH model results, including plotting
ACF of residuals and conducting , Box-Pierce and Ljung-Box tests.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_data</strong> (<em>np.array</em>) – The dataset for a specific window period.</p></li>
<li><p><strong>acf</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, plot the ACF of residuals. Defaults to True.</p></li>
<li><p><strong>test_resid</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, conduct Box-Pierce and Ljung-Box tests on residuals. Defaults to True.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.KFHedgeRatio">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">KFHedgeRatio</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/tseries.html#KFHedgeRatio"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.KFHedgeRatio" title="Link to this definition"></a></dt>
<dd><p>Estimate Hedge Ratio using Kalman Filter.
:param x: pd.Series or np.ndarray</p>
<blockquote>
<div><p>The independent variable, which can be either a pandas Series or a numpy array.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>y</strong> – pd.Series or np.ndarray
The dependent variable, which can be either a pandas Series or a numpy array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>np.ndarray</dt><dd><p>The estimated hedge ratio as a numpy array.</p>
</dd>
</dl>
</p>
</dd>
</dl>
<p>The function returns the negative of the first state variable of each Kalman Filter estimate,
which represents the estimated hedge ratio.</p>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.KFSmoother">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">KFSmoother</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></span><a class="reference internal" href="_modules/tseries.html#KFSmoother"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.KFSmoother" title="Link to this definition"></a></dt>
<dd><p>Estimate rolling mean using Kalman Smoothing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prices</strong> – pd.Series or np.ndarray
The input time series data to be smoothed. It must be either a pandas Series or a numpy array.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>pd.Series or np.ndarray</dt><dd><p>The smoothed time series data. If the input is a pandas Series, the output will also be a pandas Series with the same index.
If the input is a numpy array, the output will be a numpy array.</p>
</dd>
</dl>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">yfinance</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">yf</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prices</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s1">&#39;2020-01-01&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;2021-01-01&#39;</span><span class="p">,</span> <span class="n">multi_level_index</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prices</span> <span class="o">=</span> <span class="n">KFSmoother</span><span class="p">(</span><span class="n">prices</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">prices</span><span class="p">[:</span><span class="mi">5</span><span class="p">])</span>
<span class="go">Date</span>
<span class="go">2020-01-02 00:00:00+00:00   36.39801407</span>
<span class="go">2020-01-03 00:00:00+00:00   49.06231000</span>
<span class="go">2020-01-06 00:00:00+00:00   55.86334436</span>
<span class="go">2020-01-07 00:00:00+00:00   60.02240894</span>
<span class="go">2020-01-08 00:00:00+00:00   63.15057948</span>
<span class="go">dtype: float64</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tseries.KalmanFilterModel">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">KalmanFilterModel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tickers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#KalmanFilterModel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.KalmanFilterModel" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implements a Kalman Filter model a recursive algorithm used for estimating
the state of a linear dynamic system from a series of noisy measurements.
It’s designed to process market data, estimate dynamic parameters such as
the slope and intercept of price relationships,
forecast error and standard deviation of the predictions</p>
<p>You can learn more here <a class="reference external" href="https://en.wikipedia.org/wiki/Kalman_filter">https://en.wikipedia.org/wiki/Kalman_filter</a></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="tseries.KalmanFilterModel.Array">
<span class="sig-name descname"><span class="pre">Array</span></span><a class="headerlink" href="#tseries.KalmanFilterModel.Array" title="Link to this definition"></a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.KalmanFilterModel.calc_slope_intercep">
<span class="sig-name descname"><span class="pre">calc_slope_intercep</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span></span></span><a class="reference internal" href="_modules/tseries.html#KalmanFilterModel.calc_slope_intercep"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.KalmanFilterModel.calc_slope_intercep" title="Link to this definition"></a></dt>
<dd><p>Calculates and returns the slope and intercept
of the relationship between the provided prices using the Kalman Filter.
This method updates the filter with the latest price and returns
the estimated slope and intercept.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prices</strong> – A numpy array of prices for two financial instruments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the slope and intercept of the relationship</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.KalmanFilterModel.calculate_etqt">
<span class="sig-name descname"><span class="pre">calculate_etqt</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Tuple</span></span></span><a class="reference internal" href="_modules/tseries.html#KalmanFilterModel.calculate_etqt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.KalmanFilterModel.calculate_etqt" title="Link to this definition"></a></dt>
<dd><p>Calculates the <code class="docutils literal notranslate"><span class="pre">forecast</span> <span class="pre">error</span></code> and <code class="docutils literal notranslate"><span class="pre">standard</span> <span class="pre">deviation</span></code> of the predictions
using the Kalman Filter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>prices</strong> – A numpy array of prices for two financial instruments.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing the <code class="docutils literal notranslate"><span class="pre">forecast</span> <span class="pre">error</span></code> and <code class="docutils literal notranslate"><span class="pre">standard</span> <span class="pre">deviation</span></code> of the predictions.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="tseries.OrnsteinUhlenbeck">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">OrnsteinUhlenbeck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">returns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timeframe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'D1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#OrnsteinUhlenbeck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.OrnsteinUhlenbeck" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The Ornstein-Uhlenbeck process is a mathematical model
used to describe the behavior of a mean-reverting stochastic process.
We use it  to model the price dynamics of an asset that tends
to revert to a long-term mean.</p>
<p>We Estimate the drift (θ), volatility (σ), and long-term mean (μ)
based on historical price data; then we Simulate the OU process
using the estimated parameters.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process">https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="tseries.OrnsteinUhlenbeck.estimate_parameters">
<span class="sig-name descname"><span class="pre">estimate_parameters</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#OrnsteinUhlenbeck.estimate_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.OrnsteinUhlenbeck.estimate_parameters" title="Link to this definition"></a></dt>
<dd><p>Estimates the mean-reverting parameters (μ, θ, σ)
using the negative log-likelihood.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Estimated μ, θ, and σ.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.OrnsteinUhlenbeck.ornstein_uhlenbeck">
<span class="sig-name descname"><span class="pre">ornstein_uhlenbeck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#OrnsteinUhlenbeck.ornstein_uhlenbeck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.OrnsteinUhlenbeck.ornstein_uhlenbeck" title="Link to this definition"></a></dt>
<dd><p>Simulates the Ornstein-Uhlenbeck process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mu</strong> (<em>float</em>) – Estimated long-term mean.</p></li>
<li><p><strong>theta</strong> (<em>float</em>) – Estimated drift.</p></li>
<li><p><strong>sigma</strong> (<em>float</em>) – Estimated volatility.</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Time step.</p></li>
<li><p><strong>X0</strong> (<em>float</em>) – Initial value.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of time steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Simulated process.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="tseries.OrnsteinUhlenbeck.simulate_process">
<span class="sig-name descname"><span class="pre">simulate_process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">returns</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#OrnsteinUhlenbeck.simulate_process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.OrnsteinUhlenbeck.simulate_process" title="Link to this definition"></a></dt>
<dd><p>Simulates the OU process multiple times .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>returns</strong> (<em>np.ndarray</em>) – Historical returns.</p></li>
<li><p><strong>n</strong> (<em>int</em>) – Number of simulations to perform.</p></li>
<li><p><strong>p</strong> (<em>int</em>) – Number of time steps.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D array representing simulated processes.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.analyze_cointegrated_pairs">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">analyze_cointegrated_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spreads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_coint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosstab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">heuristics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_reg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decis_tree</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#analyze_cointegrated_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.analyze_cointegrated_pairs" title="Link to this definition"></a></dt>
<dd><p>Analyzes cointegrated pairs by visualizing, summarizing, and applying predictive models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>spreads</strong> (<em>pd.DataFrame</em>) – A DataFrame containing cointegration metrics and characteristics.
Required columns: ‘coint’, ‘t’, ‘trace0’, ‘trace1’, ‘drift’, ‘vol’, ‘corr’, ‘corr_ret’, ‘eg_sig’, ‘joh_sig’.</p></li>
<li><p><strong>plot_coint</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, generates scatterplots and boxplots to visualize cointegration characteristics.</p></li>
<li><p><strong>cosstab</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, displays crosstabulations of Engle-Granger and Johansen test significance.</p></li>
<li><p><strong>heuristics</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, prints descriptive statistics for drift, volatility, and correlation grouped by cointegration status.</p></li>
<li><p><strong>log_reg</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, fits a logistic regression model to predict cointegration and evaluates its performance.</p></li>
<li><p><strong>decis_tree</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, fits a decision tree model to predict cointegration and evaluates its performance.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
<p>Example:
&gt;&gt;&gt;   import pandas as pd
&gt;&gt;&gt;   from bbstrader.tseries import find_cointegrated_pairs, analyze_cointegrated_pairs</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>   <span class="c1"># Sample Data</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">securities</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>       <span class="s1">&#39;SPY&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">105</span><span class="p">],</span>
<span class="gp">... </span>       <span class="s1">&#39;QQQ&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="gp">... </span>   <span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">candidates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
<span class="gp">... </span>       <span class="s1">&#39;AAPL&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">104</span><span class="p">],</span>
<span class="gp">... </span>       <span class="s1">&#39;MSFT&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">205</span><span class="p">]</span>
<span class="gp">... </span>   <span class="p">})</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>   <span class="n">pairs</span> <span class="o">=</span> <span class="n">find_cointegrated_pairs</span><span class="p">(</span><span class="n">securities</span><span class="p">,</span> <span class="n">candidates</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">coint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">analyze_cointegrated_pairs</span><span class="p">(</span><span class="n">pairs</span><span class="p">,</span> <span class="n">plot_coint</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cosstab</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">heuristics</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">log_reg</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">decis_tree</span><span class="o">=</span><span class="kc">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.check_stationarity">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">check_stationarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#check_stationarity"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.check_stationarity" title="Link to this definition"></a></dt>
<dd><p>Tests the stationarity of time-series data for each asset in the DataFrame
using the Augmented Dickey-Fuller (ADF) test. Stationarity is a key property
in time-series analysis, and non-stationary data can affect model performance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame where each column represents a time series of an asset.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing the ADF p-values for each asset,
- ticker Asset name (column name from df).
- adf p-value from the ADF test, indicating the probability of the null hypothesis (data is non-stationary).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
<p>Example:
&gt;&gt;&gt; df = pd.DataFrame({
…     ‘AAPL’: [100, 101, 102, 103, 104],
…     ‘MSFT’: [200, 201, 202, 203, 204],
…     ‘GOOG’: [300, 301, 302, 303, 304]
… })
&gt;&gt;&gt; df = check_stationarity(df)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.compute_pair_metrics">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">compute_pair_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">security</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#compute_pair_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.compute_pair_metrics" title="Link to this definition"></a></dt>
<dd><p>Calculates statistical and econometric metrics for a target security and a set of candidate securities.
These metrics are useful in financial modeling and pairs trading strategies,
providing information about drift, volatility, correlation, and cointegration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>security</strong> (<em>pd.Series</em>) – A time-series of the target security’s prices.
The name of the Series should correspond to the security’s identifier (e.g., ticker symbol).</p></li>
<li><p><strong>candidates</strong> (<em>pd.DataFrame</em>) – A DataFrame where each column represents a time-series of prices
for candidate securities to be evaluated against the target security.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl>
<dt>A DataFrame combining:</dt><dd><p>Drift: Estimated drift of spreads between the target security and each candidate.
Volatility: Standard deviation of spreads.
Correlation:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">corr</span></code>: Correlation of normalized prices between the target and each candidate.
<code class="docutils literal notranslate"><span class="pre">corr_ret</span></code>: Correlation of returns (percentage change) between the target and each candidate.</p>
</div></blockquote>
<dl class="simple">
<dt>Cointegration metrics:</dt><dd><p>Engle-Granger test statistics (<code class="docutils literal notranslate"><span class="pre">t1</span></code>, <code class="docutils literal notranslate"><span class="pre">t2</span></code>) and p-values (<code class="docutils literal notranslate"><span class="pre">p1</span></code>, <code class="docutils literal notranslate"><span class="pre">p2</span></code>).
Johansen test trace statistics (<code class="docutils literal notranslate"><span class="pre">trace0</span></code>, <code class="docutils literal notranslate"><span class="pre">trace1</span></code>) and selected lag order (<code class="docutils literal notranslate"><span class="pre">k_ar_diff</span></code>).</p>
</dd>
</dl>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.find_cointegrated_pairs">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">find_cointegrated_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">securities</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">candidates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coint</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#find_cointegrated_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.find_cointegrated_pairs" title="Link to this definition"></a></dt>
<dd><p>Identifies cointegrated pairs between a target set of securities and candidate securities
based on econometric tests. The function evaluates statistical relationships,
such as cointegration and Engle-Granger significance, to determine pairs suitable
for financial strategies like pairs trading.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>securities</strong> (<cite>pd.DataFrame</cite>) – A DataFrame where each column represents the time-series
prices of target securities to evaluate.</p></li>
<li><p><strong>candidates</strong> (<cite>pd.DataFrame</cite>) – A DataFrame where each column represents the time-series
prices of candidate securities to compare against the target securities.</p></li>
<li><p><strong>n</strong> (<cite>int</cite>, optional) – The number of top pairs to return. If <cite>None</cite>, returns all pairs.</p></li>
<li><p><strong>start</strong> (<cite>str</cite>, optional) – Start date for slicing the data (e.g., ‘YYYY-MM-DD’).</p></li>
<li><p><strong>stop</strong> (<cite>str</cite>, optional) – End date for slicing the data (e.g., ‘YYYY-MM-DD’).</p></li>
<li><p><strong>coint</strong> (<cite>bool</cite>, optional, default=False) – <ul>
<li><p>If <cite>True</cite>, filters for pairs identified as cointegrated.</p></li>
<li><p>If <cite>False</cite>, returns all evaluated pairs.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>A DataFrame containing:
- Johansen and Engle-Granger cointegration metrics:</p>
<blockquote>
<div><ul class="simple">
<li><p><cite>t1</cite>, <cite>t2</cite>: Engle-Granger test statistics for two directions.</p></li>
<li><p><cite>p1</cite>, <cite>p2</cite>: Engle-Granger p-values for two directions.</p></li>
<li><p><cite>trace0</cite>, <cite>trace1</cite>: Johansen test trace statistics for 0 and 1 cointegration relationships.</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><dl class="simple">
<dt>Indicators and filters:</dt><dd><ul>
<li><p><cite>joh_sig</cite>: Indicates Johansen cointegration significance.</p></li>
<li><p><cite>eg_sig</cite>: Indicates Engle-Granger significance (p-value &lt; 0.05).</p></li>
<li><p><cite>s1_dep</cite>: Indicates whether the first series depends on the second (based on p-values).</p></li>
<li><p><cite>coint</cite>: Combined cointegration indicator (Johansen &amp; Engle-Granger).</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Spread and ranking:</dt><dd><ul>
<li><p><cite>t</cite>: Minimum of <cite>t1</cite> and <cite>t2</cite>.</p></li>
<li><p><cite>p</cite>: Minimum of <cite>p1</cite> and <cite>p2</cite>.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
<p>Example:
&gt;&gt;&gt;    import pandas as pd</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>   <span class="c1"># Sample Data</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">data_securities</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>       <span class="s1">&#39;Security1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">105</span><span class="p">],</span>
<span class="gp">... </span>       <span class="s1">&#39;Security2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">54</span><span class="p">]</span>
<span class="gp">... </span>   <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">data_candidates</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>       <span class="s1">&#39;Candidate1&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">101</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">104</span><span class="p">],</span>
<span class="gp">... </span>       <span class="s1">&#39;Candidate2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">202</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">205</span><span class="p">]</span>
<span class="gp">... </span>   <span class="p">}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>   <span class="n">securities</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_securities</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">candidates</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data_candidates</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">date_range</span><span class="p">(</span><span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="n">periods</span><span class="o">=</span><span class="mi">5</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>   <span class="c1"># Find cointegrated pairs</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">top_pairs</span> <span class="o">=</span> <span class="n">find_cointegrated_pairs</span><span class="p">(</span><span class="n">securities</span><span class="p">,</span> <span class="n">candidates</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">coint</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="nb">print</span><span class="p">(</span><span class="n">top_pairs</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span>   <span class="o">|</span> <span class="n">s1</span>       <span class="o">|</span> <span class="n">s2</span>        <span class="o">|</span> <span class="n">t</span>    <span class="o">|</span> <span class="n">p</span>     <span class="o">|</span> <span class="n">joh_sig</span> <span class="o">|</span> <span class="n">eg_sig</span> <span class="o">|</span> <span class="n">coint</span> <span class="o">|</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">|----------|-----------|------|-------|---------|--------|-------|</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">|</span> <span class="n">Security1</span><span class="o">|</span> <span class="n">Candidate1</span><span class="o">|</span> <span class="o">-</span><span class="mf">3.5</span> <span class="o">|</span> <span class="mf">0.01</span>  <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mi">1</span>      <span class="o">|</span> <span class="mi">1</span>     <span class="o">|</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">|</span> <span class="n">Security2</span><span class="o">|</span> <span class="n">Candidate2</span><span class="o">|</span> <span class="o">-</span><span class="mf">2.9</span> <span class="o">|</span> <span class="mf">0.04</span>  <span class="o">|</span> <span class="mi">1</span>       <span class="o">|</span> <span class="mi">1</span>      <span class="o">|</span> <span class="mi">1</span>     <span class="o">|</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.fit_best_arima">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">fit_best_arima</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#fit_best_arima"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.fit_best_arima" title="Link to this definition"></a></dt>
<dd><p>Identifies and fits the best <cite>ARIMA</cite> model
based on the Akaike Information Criterion <cite>(AIC)</cite>.</p>
<p>Iterates through different combinations of <cite>p</cite> and <cite>q</cite>
parameters (within specified ranges) for the ARIMA model,
fits them to the provided data, and selects the combination
with the lowest <cite>AIC</cite> value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>window_data</strong> (<em>pd.Series</em><em> or </em><em>np.ndarray</em>) – Time series data to fit the <cite>ARIMA</cite> model on.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The fitted <cite>ARIMA</cite> model with the lowest <cite>AIC</cite>.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ARIMA result object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.fit_garch">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">fit_garch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#fit_garch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.fit_garch" title="Link to this definition"></a></dt>
<dd><p>Fits an <cite>ARIMA</cite> model to the data to get residuals,
then fits a <cite>GARCH(1,1)</cite> model on these residuals.</p>
<p>Utilizes the residuals from the best <cite>ARIMA</cite> model fit to
then model volatility using a <cite>GARCH(1,1)</cite> model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>window_data</strong> (<em>pd.Series</em><em> or </em><em>np.ndarray</em>) – Time series data for which to fit the <cite>ARIMA</cite> and <cite>GARCH</cite> models.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing the <cite>ARIMA</cite> result</dt><dd><p>object and the <cite>GARCH</cite> result object.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.get_corr">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">get_corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tickers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/tseries.html#get_corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.get_corr" title="Link to this definition"></a></dt>
<dd><p>Calculates and prints the correlation matrix of the adjusted closing prices
for a given list of stock tickers within a specified date range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tickers</strong> (<em>A list</em><em> or </em><em>tuple</em><em> of </em><em>valid stock</em>)</p></li>
<li><p><strong>tickers</strong></p></li>
<li><p><strong>start</strong> (<em>str</em>) – The start date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
<li><p><strong>end</strong> (<em>str</em>) – The end date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
</ul>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; from bbstrader.tseries import get_corr
&gt;&gt;&gt; get_corr([‘AAPL’, ‘MSFT’, ‘GOOG’], ‘2023-01-01’, ‘2023-12-31’)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.get_prediction">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">get_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">window_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#get_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.get_prediction" title="Link to this definition"></a></dt>
<dd><p>Orchestrator function to get the next period’s return prediction.</p>
<p>This function ties together the process of fitting
both <cite>ARIMA</cite> and <cite>GARCH</cite> models on the provided data
and then predicting the next period’s return using these models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>window_data</strong> (<em>Union</em><em>[</em><em>pd.Series</em><em> , </em><em>np.ndarray</em><em>]</em>) – Time series data to fit the models and predict the next return.</p>
</dd>
</dl>
<dl class="simple">
<dt>Returns</dt><dd><p>float: Predicted next return value.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.load_and_prepare_data">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">load_and_prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#load_and_prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.load_and_prepare_data" title="Link to this definition"></a></dt>
<dd><p>Prepares financial time series data for analysis.</p>
<p>This function takes a pandas DataFrame containing financial data,
calculates logarithmic returns, and the first difference
of these logarithmic returns. It handles missing values
by filling them with zeros.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – DataFrame containing at least
a <cite>Close</cite> column with closing prices of a financial asset.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>DataFrame with additional</dt><dd><p>columns for logarithmic returns (<cite>log_return</cite>)
and the first difference of logarithmic returns (<cite>diff_log_return</cite>),
with <cite>NaN</cite> values filled with <cite>0</cite>.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.predict_next_return">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">predict_next_return</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">arima_result</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">garch_result</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#predict_next_return"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.predict_next_return" title="Link to this definition"></a></dt>
<dd><p>Predicts the next return value using fitted <cite>ARIMA</cite> and <cite>GARCH</cite> models.</p>
<p>Combines the next period forecast from the <cite>ARIMA</cite> model
with the next period volatility forecast from the <cite>GARCH</cite> model
to predict the next return value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arima_result</strong> (<em>ARIMA result object</em>) – The fitted <cite>ARIMA</cite> model result.</p></li>
<li><p><strong>garch_result</strong> (<em>ARCH result object</em>) – The fitted <cite>GARCH</cite> model result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The predicted next return, adjusted for predicted volatility.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.remove_correlated_assets">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">remove_correlated_assets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#remove_correlated_assets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.remove_correlated_assets" title="Link to this definition"></a></dt>
<dd><p>Removes highly correlated assets from a DataFrame based on a specified correlation cutoff threshold.
This is useful in financial data analysis to reduce redundancy and multicollinearity in portfolios or datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame where each column represents an asset
and rows represent observations (e.g., time-series data).</p></li>
<li><p><strong>cutoff</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=0.99</em>) – The correlation threshold.
Columns with absolute correlation greater than this value will be considered for removal.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A DataFrame with less correlated assets.</dt><dd><p>The columns that are highly correlated (above the cutoff) are removed.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
<p>Example:
&gt;&gt;&gt; df = pd.DataFrame({
…     ‘AAPL’: [100, 101, 102, 103, 104],
…     ‘MSFT’: [200, 201, 202, 203, 204],
…     ‘GOOG’: [300, 301, 302, 303, 304]
… })
&gt;&gt;&gt; df =  remove_correlated_assets(df)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.remove_stationary_assets">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">remove_stationary_assets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#remove_stationary_assets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.remove_stationary_assets" title="Link to this definition"></a></dt>
<dd><p>Filters out stationary assets from the DataFrame based on the p-value obtained
from the Augmented Dickey-Fuller test.
Useful for focusing only on non-stationary time-series data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A DataFrame where each column represents a time series of an asset.</p></li>
<li><p><strong>pval</strong> (<em>float</em><em>, </em><em>optional</em><em>, </em><em>default=0.05</em>) – The significance level to determine stationarity.
Columns with an ADF test p-value below this threshold are considered stationary and removed.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing only the non-stationary assets.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
<p>Example:
&gt;&gt;&gt; df = pd.DataFrame({
…     ‘AAPL’: [100, 101, 102, 103, 104],
…     ‘MSFT’: [200, 201, 202, 203, 204],
…     ‘GOOG’: [300, 301, 302, 303, 304]
… })
&gt;&gt;&gt; df = remove_stationary_assets(df)</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.run_cadf_test">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">run_cadf_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/tseries.html#run_cadf_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.run_cadf_test" title="Link to this definition"></a></dt>
<dd><p>Performs the Cointegration Augmented Dickey-Fuller (CADF) test on a pair of stock tickers
over a specified date range to check for cointegration.</p>
<p>The function downloads historical adjusted closing prices for the specified pair of stock tickers,
calculates the optimal hedge ratio (beta) using Ordinary Least Squares (OLS) regression, plots the
time series and their residuals, and finally performs the CADF test on the residuals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pair</strong> (<em>List</em><em>[</em><em>str</em><em>] or </em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em>) – A list or tuple containing two valid stock tickers (e.g., [‘AAPL’, ‘MSFT’]).</p></li>
<li><p><strong>start</strong> (<em>str</em>) – The start date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
<li><p><strong>end</strong> (<em>str</em>) – The end date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">bbstrader.tseries</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_cadf_test</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_cadf_test</span><span class="p">([</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">],</span> <span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Regression</span> <span class="n">Metrics</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Optimal</span> <span class="n">Hedge</span> <span class="n">Ratio</span> <span class="p">(</span><span class="n">Beta</span><span class="p">):</span> <span class="mf">2.2485845594120333</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Result</span> <span class="n">Parmas</span><span class="p">:</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">const</span>   <span class="o">-</span><span class="mf">74.418034</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AAPL</span>      <span class="mf">2.248585</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtype</span><span class="p">:</span> <span class="n">float64</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Regression</span> <span class="n">Summary</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>                             <span class="n">OLS</span> <span class="n">Regression</span> <span class="n">Results</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">==============================================================================</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dep</span><span class="o">.</span> <span class="n">Variable</span><span class="p">:</span>                   <span class="n">MSFT</span>   <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>                       <span class="mf">0.900</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Model</span><span class="p">:</span>                            <span class="n">OLS</span>   <span class="n">Adj</span><span class="o">.</span> <span class="n">R</span><span class="o">-</span><span class="n">squared</span><span class="p">:</span>                  <span class="mf">0.900</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Method</span><span class="p">:</span>                 <span class="n">Least</span> <span class="n">Squares</span>   <span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">:</span>                     <span class="mf">2244.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Date</span><span class="p">:</span>                <span class="n">Sat</span><span class="p">,</span> <span class="mi">20</span> <span class="n">Jul</span> <span class="mi">2024</span>   <span class="n">Prob</span> <span class="p">(</span><span class="n">F</span><span class="o">-</span><span class="n">statistic</span><span class="p">):</span>          <span class="mf">2.95e-126</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Time</span><span class="p">:</span>                        <span class="mi">13</span><span class="p">:</span><span class="mi">36</span><span class="p">:</span><span class="mi">58</span>   <span class="n">Log</span><span class="o">-</span><span class="n">Likelihood</span><span class="p">:</span>                <span class="o">-</span><span class="mf">996.45</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">No</span><span class="o">.</span> <span class="n">Observations</span><span class="p">:</span>                 <span class="mi">250</span>   <span class="n">AIC</span><span class="p">:</span>                             <span class="mf">1997.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Df</span> <span class="n">Residuals</span><span class="p">:</span>                     <span class="mi">248</span>   <span class="n">BIC</span><span class="p">:</span>                             <span class="mf">2004.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Df</span> <span class="n">Model</span><span class="p">:</span>                           <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Covariance</span> <span class="n">Type</span><span class="p">:</span>            <span class="n">nonrobust</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">==============================================================================</span>
<span class="gp">&gt;&gt;&gt; </span>                 <span class="n">coef</span>    <span class="n">std</span> <span class="n">err</span>          <span class="n">t</span>      <span class="n">P</span><span class="o">&gt;|</span><span class="n">t</span><span class="o">|</span>      <span class="p">[</span><span class="mf">0.025</span>      <span class="mf">0.975</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">------------------------------------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">const</span>        <span class="o">-</span><span class="mf">74.4180</span>      <span class="mf">8.191</span>     <span class="o">-</span><span class="mf">9.085</span>      <span class="mf">0.000</span>     <span class="o">-</span><span class="mf">90.551</span>     <span class="o">-</span><span class="mf">58.286</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">AAPL</span>           <span class="mf">2.2486</span>      <span class="mf">0.047</span>     <span class="mf">47.369</span>      <span class="mf">0.000</span>       <span class="mf">2.155</span>       <span class="mf">2.342</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">==============================================================================</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Omnibus</span><span class="p">:</span>                        <span class="mf">4.923</span>   <span class="n">Durbin</span><span class="o">-</span><span class="n">Watson</span><span class="p">:</span>                   <span class="mf">0.121</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Prob</span><span class="p">(</span><span class="n">Omnibus</span><span class="p">):</span>                  <span class="mf">0.085</span>   <span class="n">Jarque</span><span class="o">-</span><span class="n">Bera</span> <span class="p">(</span><span class="n">JB</span><span class="p">):</span>                <span class="mf">4.862</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Skew</span><span class="p">:</span>                           <span class="mf">0.342</span>   <span class="n">Prob</span><span class="p">(</span><span class="n">JB</span><span class="p">):</span>                       <span class="mf">0.0879</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Kurtosis</span><span class="p">:</span>                       <span class="mf">2.993</span>   <span class="n">Cond</span><span class="o">.</span> <span class="n">No</span><span class="o">.</span>                     <span class="mf">1.71e+03</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">==============================================================================</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Notes</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="n">Standard</span> <span class="n">Errors</span> <span class="n">assume</span> <span class="n">that</span> <span class="n">the</span> <span class="n">covariance</span> <span class="n">matrix</span> <span class="n">of</span> <span class="n">the</span> <span class="n">errors</span> <span class="ow">is</span> <span class="n">correctly</span> <span class="n">specified</span><span class="o">.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="n">The</span> <span class="n">condition</span> <span class="n">number</span> <span class="ow">is</span> <span class="n">large</span><span class="p">,</span> <span class="mf">1.71e+03</span><span class="o">.</span> <span class="n">This</span> <span class="n">might</span> <span class="n">indicate</span> <span class="n">that</span> <span class="n">there</span> <span class="n">are</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">strong</span> <span class="n">multicollinearity</span> <span class="ow">or</span> <span class="n">other</span> <span class="n">numerical</span> <span class="n">problems</span><span class="o">.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Cointegration</span> <span class="n">TEST</span> <span class="n">Results</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="o">-</span><span class="mf">3.204126144947765</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">0.019747080611767602</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">0</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">249</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">{</span><span class="s1">&#39;1%&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="o">-</span><span class="mf">3.4568881317725864</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;10%&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="o">-</span><span class="mf">2.5729936189738876</span><span class="p">),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;5%&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="o">-</span><span class="mf">2.8732185133016057</span><span class="p">)},</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">float64</span><span class="p">(</span><span class="mf">1364.3866758546171</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.run_coint_test">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">run_coint_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tickers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/tseries.html#run_coint_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.run_coint_test" title="Link to this definition"></a></dt>
<dd><p>Performs pairwise cointegration tests on a list of stock tickers over a specified date range.</p>
<p>For each unique pair of tickers, the function downloads historical adjusted closing prices and
tests for cointegration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tickers</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – A list of valid stock ticker symbols (e.g., [‘AAPL’, ‘MSFT’, ‘GOOG’]).</p></li>
<li><p><strong>start</strong> (<em>str</em>) – The start date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
<li><p><strong>end</strong> (<em>str</em>) – The end date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
</ul>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; from bbstrader.tseries import run_coint_test</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_coint_test</span><span class="p">([</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;MSFT&#39;</span><span class="p">,</span> <span class="s1">&#39;GOOG&#39;</span><span class="p">],</span> <span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.run_hurst_test">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">run_hurst_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">symbol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#run_hurst_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.run_hurst_test" title="Link to this definition"></a></dt>
<dd><p>Calculates and prints the Hurst Exponent for a given stock’s adjusted closing prices
within a specified date range, and for three generated series (Geometric Brownian Motion,
Mean-Reverting, and Trending).</p>
<p>The Hurst Exponent is used to determine the long-term memory of a time series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>symbol</strong> (<em>str</em>) – A valid stock ticker symbol (e.g., ‘AAPL’).</p></li>
<li><p><strong>start</strong> (<em>str</em>) – The start date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
<li><p><strong>end</strong> (<em>str</em>) – The end date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
</ul>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; from bbstrader.tseries import run_hurst_test</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_hurst_test</span><span class="p">(</span><span class="s1">&#39;AAPL&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.run_kalman_filter">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">run_kalman_filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">etfs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/tseries.html#run_kalman_filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.run_kalman_filter" title="Link to this definition"></a></dt>
<dd><p>Applies a Kalman filter to a pair of assets adjusted closing prices within a specified date range
to estimate the slope and intercept over time.</p>
<p>The function downloads historical adjusted closing prices for the specified pair of assets,
visualizes their price relationship, calculates the Kalman filter estimates for the slope and
intercept, and visualizes the changes in these estimates over time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>etfs</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>] </em><em>, </em><em>Tuple</em><em>[</em><em>str</em><em>, </em><em>...</em><em>]</em><em>]</em>)</p></li>
<li><p><strong>tickers</strong> (<em>A list</em><em> or </em><em>tuple containing two valid assets</em>)</p></li>
<li><p><strong>start</strong> (<em>str</em>) – The start date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
<li><p><strong>end</strong> (<em>str</em>) – The end date for the historical data in ‘YYYY-MM-DD’ format.</p></li>
</ul>
</dd>
</dl>
<p>Example:
&gt;&gt;&gt; from bbstrader.tseries import run_kalman_filter</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">run_kalman_filter</span><span class="p">([</span><span class="s1">&#39;SPY&#39;</span><span class="p">,</span> <span class="s1">&#39;QQQ&#39;</span><span class="p">],</span> <span class="s1">&#39;2023-01-01&#39;</span><span class="p">,</span> <span class="s1">&#39;2023-12-31&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.select_assets">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">select_assets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">end</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rolling_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#select_assets"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.select_assets" title="Link to this definition"></a></dt>
<dd><p>Selects the top N assets based on the average trading volume from the input DataFrame.
These assets are used as universe in which we can search cointegrated pairs for pairs trading strategies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – A multi-index DataFrame with levels [‘ticker’, ‘date’] containing market data.
Must include columns ‘close’ (price) and ‘volume’.</p></li>
<li><p><strong>n</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of assets to select based on highest average trading volume. Default is 100.</p></li>
<li><p><strong>start</strong> (<em>str</em><em>, </em><em>optional</em>) – Start date for filtering the data. Default is the earliest date in the DataFrame.</p></li>
<li><p><strong>end</strong> (<em>str</em><em>, </em><em>optional</em>) – End date for filtering the data. Default is the latest date in the DataFrame.</p></li>
<li><p><strong>rolling_window</strong> (<em>int</em><em>, </em><em>optional</em>) – Rolling window for calculating the average trading volume. Default is None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame of selected assets with filtered, cleaned data, indexed by date.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tseries.select_candidate_pairs">
<span class="sig-prename descclassname"><span class="pre">tseries.</span></span><span class="sig-name descname"><span class="pre">select_candidate_pairs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pairs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">period</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/tseries.html#select_candidate_pairs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tseries.select_candidate_pairs" title="Link to this definition"></a></dt>
<dd><p>Select candidate pairs from a DataFrame based on cointegration status.</p>
<p>This function filters the input DataFrame to select pairs where the ‘coint’ column equals 1,
indicating cointegration. It then determines the dependent and independent series for each pair
and returns the selected pairs in a dictionary format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pairs</strong> (<em>pd.DataFrame</em>) – A DataFrame containing pairs of time series with columns ‘coint’, ‘s1’, ‘s2’, and ‘s1_dep’.</p></li>
<li><p><strong>period</strong> (<em>bool</em><em>, </em><em>optional</em>) – If True, includes the ‘period’ column in the output. Defaults to False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A list of dictionaries, each containing the keys ‘x’ and ‘y’ (and optionally ‘period’) representing the selected pairs.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list[dict]</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Stefan Jansen (2020). Machine Learning for Algorithmic Trading - Second Edition.
chapter 9, Time-Series Models for Volatility Forecasts and Statistical Arbitrage.</p>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="trading.html" class="btn btn-neutral float-left" title="Trading Execution" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 - 2025, Bertin Balouki SIMYELI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>