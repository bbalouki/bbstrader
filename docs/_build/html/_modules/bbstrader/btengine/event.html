

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bbstrader.btengine.event &mdash; bbstrader 0.3.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../_static/documentation_options.js?v=e259d695"></script>
      <script src="../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../index.html" class="icon icon-home">
            bbstrader
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../modules.html">bbstrader</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">bbstrader</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">bbstrader.btengine.event</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for bbstrader.btengine.event</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">enum</span><span class="w"> </span><span class="kn">import</span> <span class="n">Enum</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Literal</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Event&quot;</span><span class="p">,</span> <span class="s2">&quot;Events&quot;</span><span class="p">,</span>  <span class="s2">&quot;MarketEvent&quot;</span><span class="p">,</span> <span class="s2">&quot;SignalEvent&quot;</span><span class="p">,</span> <span class="s2">&quot;OrderEvent&quot;</span><span class="p">,</span> <span class="s2">&quot;FillEvent&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="Event">
<a class="viewcode-back" href="../../../bbstrader.btengine.html#bbstrader.btengine.event.Event">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Event</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Event is base class providing an interface for all subsequent</span>
<span class="sd">    (inherited) events, that will trigger further events in the</span>
<span class="sd">    trading infrastructure.</span>
<span class="sd">    Since in many implementations the Event objects will likely develop greater</span>
<span class="sd">    complexity, it is thus being &quot;future-proofed&quot; by creating a class hierarchy.</span>
<span class="sd">    The Event class is simply a way to ensure that all events have a common interface</span>
<span class="sd">    and can be handled in a consistent manner.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="o">...</span></div>



<div class="viewcode-block" id="Events">
<a class="viewcode-back" href="../../../bbstrader.btengine.html#bbstrader.btengine.event.Events">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Events</span><span class="p">(</span><span class="n">Enum</span><span class="p">):</span>
    <span class="n">MARKET</span> <span class="o">=</span> <span class="s2">&quot;MARKET&quot;</span>
    <span class="n">SIGNAL</span> <span class="o">=</span> <span class="s2">&quot;SIGNAL&quot;</span>
    <span class="n">ORDER</span> <span class="o">=</span> <span class="s2">&quot;ORDER&quot;</span>
    <span class="n">FILL</span> <span class="o">=</span> <span class="s2">&quot;FILL&quot;</span></div>



<div class="viewcode-block" id="MarketEvent">
<a class="viewcode-back" href="../../../bbstrader.btengine.html#bbstrader.btengine.event.MarketEvent">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">MarketEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Market Events are triggered when the outer while loop of the backtesting</span>
<span class="sd">    system begins a new `&quot;heartbeat&quot;`. It occurs when the `DataHandler` object</span>
<span class="sd">    receives a new update of market data for any symbols which are currently</span>
<span class="sd">    being tracked. It is used to `trigger the Strategy object` generating</span>
<span class="sd">    new `trading signals`. The event object simply contains an identification</span>
<span class="sd">    that it is a market event, with no other structure.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises the MarketEvent.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Events</span><span class="o">.</span><span class="n">MARKET</span></div>



<div class="viewcode-block" id="SignalEvent">
<a class="viewcode-back" href="../../../bbstrader.btengine.html#bbstrader.btengine.event.SignalEvent">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">SignalEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The `Strategy object` utilises market data to create new `SignalEvents`.</span>
<span class="sd">    The SignalEvent contains a `strategy ID`, a `ticker symbol`, a `timestamp`</span>
<span class="sd">    for when it was generated, a `direction` (long or short) and a `&quot;strength&quot;`</span>
<span class="sd">    indicator (this is useful for mean reversion strategies) and the `quantiy`</span>
<span class="sd">    to buy or sell. The `SignalEvents` are utilised by the `Portfolio object`</span>
<span class="sd">    as advice for how to trade.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">strategy_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">datetime</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">signal_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;LONG&quot;</span><span class="p">,</span> <span class="s2">&quot;SHORT&quot;</span><span class="p">,</span> <span class="s2">&quot;EXIT&quot;</span><span class="p">],</span>
        <span class="n">quantity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span>
        <span class="n">strength</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="n">price</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">stoplimit</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises the SignalEvent.</span>

<span class="sd">        Args:</span>
<span class="sd">            strategy_id (int): The unique identifier for the strategy that</span>
<span class="sd">                generated the signal.</span>

<span class="sd">            symbol (str): The ticker symbol, e.g. &#39;GOOG&#39;.</span>
<span class="sd">            datetime (datetime): The timestamp at which the signal was generated.</span>
<span class="sd">            signal_type (str): &#39;LONG&#39; or &#39;SHORT&#39; or &#39;EXIT&#39;.</span>
<span class="sd">            quantity (int | float): An optional integer (or float) representing the order size.</span>
<span class="sd">            strength (int | float): An adjustment factor &quot;suggestion&quot; used to scale</span>
<span class="sd">                quantity at the portfolio level. Useful for pairs strategies.</span>
<span class="sd">            price (int | float): An optional price to be used when the signal is generated.</span>
<span class="sd">            stoplimit (int | float): An optional stop-limit price for the signal</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Events</span><span class="o">.</span><span class="n">SIGNAL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strategy_id</span> <span class="o">=</span> <span class="n">strategy_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="n">symbol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datetime</span> <span class="o">=</span> <span class="n">datetime</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signal_type</span> <span class="o">=</span> <span class="n">signal_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span> <span class="o">=</span> <span class="n">quantity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">strength</span> <span class="o">=</span> <span class="n">strength</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="n">price</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">stoplimit</span> <span class="o">=</span> <span class="n">stoplimit</span></div>



<div class="viewcode-block" id="OrderEvent">
<a class="viewcode-back" href="../../../bbstrader.btengine.html#bbstrader.btengine.event.OrderEvent">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">OrderEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    When a Portfolio object receives `SignalEvents` it assesses them</span>
<span class="sd">    in the wider context of the portfolio, in terms of risk and position sizing.</span>
<span class="sd">    This ultimately leads to `OrderEvents` that will be sent to an `ExecutionHandler`.</span>

<span class="sd">    The `OrderEvents` is slightly more complex than a `SignalEvents` since</span>
<span class="sd">    it contains a quantity field in addition to the aforementioned properties</span>
<span class="sd">    of SignalEvent. The quantity is determined by the Portfolio constraints.</span>
<span class="sd">    In addition the OrderEvent has a `print_order()` method, used to output the</span>
<span class="sd">    information to the console if necessary.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">order_type</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;MKT&quot;</span><span class="p">,</span> <span class="s2">&quot;LMT&quot;</span><span class="p">,</span> <span class="s2">&quot;STP&quot;</span><span class="p">,</span> <span class="s2">&quot;STPLMT&quot;</span><span class="p">],</span>
        <span class="n">quantity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">direction</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BUY&quot;</span><span class="p">,</span> <span class="s2">&quot;SELL&quot;</span><span class="p">],</span>
        <span class="n">price</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">signal</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises the order type, setting whether it is</span>
<span class="sd">        a Market order (&#39;MKT&#39;) or Limit order (&#39;LMT&#39;), or Stop order (&#39;STP&#39;).</span>
<span class="sd">        a quantity (integral or float) and its direction (&#39;BUY&#39; or &#39;SELL&#39;).</span>

<span class="sd">        Args:</span>
<span class="sd">            symbol (str): The instrument to trade.</span>
<span class="sd">            order_type (str): &#39;MKT&#39; or &#39;LMT&#39; for Market or Limit.</span>
<span class="sd">            quantity (int | float): Non-negative number for quantity.</span>
<span class="sd">            direction (str): &#39;BUY&#39; or &#39;SELL&#39; for long or short.</span>
<span class="sd">            price (int | float): The price at which to order.</span>
<span class="sd">            signal (str): The signal that generated the order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Events</span><span class="o">.</span><span class="n">ORDER</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="n">symbol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order_type</span> <span class="o">=</span> <span class="n">order_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span> <span class="o">=</span> <span class="n">quantity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">price</span> <span class="o">=</span> <span class="n">price</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signal</span> <span class="o">=</span> <span class="n">signal</span>

<div class="viewcode-block" id="OrderEvent.print_order">
<a class="viewcode-back" href="../../../bbstrader.btengine.html#bbstrader.btengine.event.OrderEvent.print_order">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print_order</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Outputs the values within the Order.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Order: Symbol=</span><span class="si">%s</span><span class="s2">, Type=</span><span class="si">%s</span><span class="s2">, Quantity=</span><span class="si">%s</span><span class="s2">, Direction=</span><span class="si">%s</span><span class="s2">, Price=</span><span class="si">%s</span><span class="s2">&quot;</span>
            <span class="o">%</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">order_type</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">price</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span></div>
</div>




<div class="viewcode-block" id="FillEvent">
<a class="viewcode-back" href="../../../bbstrader.btengine.html#bbstrader.btengine.event.FillEvent">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">FillEvent</span><span class="p">(</span><span class="n">Event</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    When an `ExecutionHandler` receives an `OrderEvent` it must transact the order.</span>
<span class="sd">    Once an order has been transacted it generates a `FillEvent`, which describes</span>
<span class="sd">    the cost of purchase or sale as well as the transaction costs, such as fees</span>
<span class="sd">    or slippage.</span>

<span class="sd">    The `FillEvent` is the Event with the greatest complexity.</span>
<span class="sd">    It contains a `timestamp` for when an order was filled, the `symbol`</span>
<span class="sd">    of the order and the `exchange` it was executed on, the `quantity`</span>
<span class="sd">    of shares transacted, the `actual price of the purchase` and the `commission</span>
<span class="sd">    incurred`.</span>

<span class="sd">    The commission is calculated using the Interactive Brokers commissions.</span>
<span class="sd">    For US API orders this commission is `1.30 USD` minimum per order, with a flat</span>
<span class="sd">    rate of either 0.013 USD or 0.08 USD per share depending upon whether</span>
<span class="sd">    the trade size is below or above `500 units` of stock.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">timeindex</span><span class="p">:</span> <span class="n">datetime</span><span class="p">,</span>
        <span class="n">symbol</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">exchange</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">quantity</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span><span class="p">,</span>
        <span class="n">direction</span><span class="p">:</span> <span class="n">Literal</span><span class="p">[</span><span class="s2">&quot;BUY&quot;</span><span class="p">,</span> <span class="s2">&quot;SELL&quot;</span><span class="p">],</span>
        <span class="n">fill_cost</span><span class="p">:</span> <span class="nb">int</span> <span class="o">|</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">commission</span><span class="p">:</span> <span class="nb">float</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">order</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialises the FillEvent object. Sets the symbol, exchange,</span>
<span class="sd">        quantity, direction, cost of fill and an optional</span>
<span class="sd">        commission.</span>

<span class="sd">        If commission is not provided, the Fill object will</span>
<span class="sd">        calculate it based on the trade size and Interactive</span>
<span class="sd">        Brokers fees.</span>

<span class="sd">        Args:</span>
<span class="sd">            timeindex (datetime): The bar-resolution when the order was filled.</span>
<span class="sd">            symbol (str): The instrument which was filled.</span>
<span class="sd">            exchange (str): The exchange where the order was filled.</span>
<span class="sd">            quantity (int | float): The filled quantity.</span>
<span class="sd">            direction (str): The direction of fill `(&#39;LONG&#39;, &#39;SHORT&#39;, &#39;EXIT&#39;)`</span>
<span class="sd">            fill_cost (int | float): Price of the shares when filled.</span>
<span class="sd">            commission (float | None): An optional commission sent from IB.</span>
<span class="sd">            order (str): The order that this fill is related</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">Events</span><span class="o">.</span><span class="n">FILL</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">timeindex</span> <span class="o">=</span> <span class="n">timeindex</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">symbol</span> <span class="o">=</span> <span class="n">symbol</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exchange</span> <span class="o">=</span> <span class="n">exchange</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span> <span class="o">=</span> <span class="n">quantity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fill_cost</span> <span class="o">=</span> <span class="n">fill_cost</span>
        <span class="c1"># Calculate commission</span>
        <span class="k">if</span> <span class="n">commission</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">commission</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculate_ib_commission</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">commission</span> <span class="o">=</span> <span class="n">commission</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">order</span> <span class="o">=</span> <span class="n">order</span>

<div class="viewcode-block" id="FillEvent.calculate_ib_commission">
<a class="viewcode-back" href="../../../bbstrader.btengine.html#bbstrader.btengine.event.FillEvent.calculate_ib_commission">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate_ib_commission</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculates the fees of trading based on an Interactive</span>
<span class="sd">        Brokers fee structure for API, in USD.</span>
<span class="sd">        This does not include exchange or ECN fees.</span>
<span class="sd">        Based on &quot;US API Directed Orders&quot;:</span>
<span class="sd">        https://www.interactivebrokers.com/en/index.php?f=commission&amp;p=stocks2</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">full_cost</span> <span class="o">=</span> <span class="mf">1.3</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span> <span class="o">&lt;=</span> <span class="mi">500</span><span class="p">:</span>
            <span class="n">full_cost</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.013</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">full_cost</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.3</span><span class="p">,</span> <span class="mf">0.008</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">quantity</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">full_cost</span></div>
</div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023 - 2025, Bertin Balouki SIMYELI.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>